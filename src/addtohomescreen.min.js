/* Add to Homescreen v3.1.1 ~ (c) 2014 Matteo Spinelli ~ @license: http://cubiq.org/license */
(function(n,t){function v(){n.removeEventListener("load",v,!1);e=!0}function i(n){return o=o||new i.Class(n)}function l(n,t){for(var i in t)n[i]=t[i];return n}function y(){t.location.hash=="#ath"&&history.replaceState("",n.document.title,t.location.href.split("#")[0]);u.test(t.location.href)&&history.replaceState("",n.document.title,t.location.href.replace(u,"$1"));f.test(t.location.search)&&history.replaceState("",n.document.title,t.location.href.replace(f,"$2"))}var a="addEventListener"in n,e=!1,u,f,o,s,r,h,c;t.readyState==="complete"?e=!0:a&&n.addEventListener("load",v,!1);u=/\/ath(\/)?$/;f=/([\?&]ath=[^&]*$|&ath=[^&]*(&))/;i.intl={de_de:{ios:"Um diese Web-App zum Home-Bildschirm hinzuzufügen, tippen Sie auf %icon und dann <strong>Zum Home-Bildschirm<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},en_us:{ios:"To add this web app to the home screen: tap %icon and then <strong>Add to Home Screen<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},es_es:{ios:"Para añadir esta aplicación web a la pantalla de inicio: pulsa %icon y selecciona <strong>Añadir a pantalla de inicio<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},fr_fr:{ios:"Pour ajouter cette application web sur l'écran d'accueil : Appuyez %icon et sélectionnez <strong>Ajouter sur l'écran d'accueil<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},he_il:{ios:'<span dir="rtl">להוספת האפליקציה למסך הבית: ללחוץ על %icon ואז <strong>הוסף למסך הבית<\/strong>.<\/span>',android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},it_it:{ios:"Per aggiungere questa web app alla schermata iniziale: premi %icon e poi <strong>Aggiungi a Home<\/strong>.",android:'Per aggiungere questa web app alla schermata iniziale, apri il menu opzioni del browser e premi su <strong>Aggiungi alla homescreen<\/strong>. <small>Puoi accedere al menu premendo il pulsante hardware delle opzioni se la tua device ne ha uno, oppure premendo l\'icona <span class="ath-action-icon">icon<\/span> in alto a destra.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},nb_no:{ios:"For å installere denne appen på hjem-skjermen: trykk på %icon og deretter <strong>Legg til på Hjem-skjerm<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},pt_br:{ios:"Para adicionar este app à tela de início: clique %icon e então <strong>Tela de início<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},pt_pt:{ios:"Para adicionar esta app ao ecrã principal: clique %icon e depois <strong>Ecrã principal<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},nl_nl:{ios:"Om deze webapp op je telefoon te installeren, klik op %icon en dan <strong>Zet in beginscherm<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},sv_se:{ios:"För att lägga till denna webbapplikation på hemskärmen: tryck på %icon och därefter <strong>Lägg till på hemskärmen<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},zh_cn:{ios:"如要把应用程式加至主屏幕,请点击%icon, 然后<strong>加至主屏幕<\/strong>",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."},zh_tw:{ios:"如要把應用程式加至主屏幕, 請點擊%icon, 然後<strong>加至主屏幕<\/strong>.",android:'To add this web app to the home screen open the browser option menu and tap on <strong>Add to homescreen<\/strong>. <small>The menu can be accessed by pressing the menu hardware button if your device has one, or by tapping the top right menu icon <span class="ath-action-icon">icon<\/span>.<\/small>',windows:"To add this web app to your start screen: tap the %icon and then <strong>pin to start<\/strong>."}};for(s in i.intl)i.intl[s.substr(0,2)]=i.intl[s];i.defaults={appID:"org.cubiq.addtohome",fontSize:15,debug:!1,modal:!1,mandatory:!1,autostart:!0,skipFirstVisit:!1,startDelay:1,lifespan:15,displayPace:1440,maxDisplayCount:0,icon:!0,message:"",validLocation:[],onInit:null,onShow:null,onRemove:null,onAdd:null,onPrivate:null,privateModeOverride:!1,detectHomescreen:!1};r=n.navigator.userAgent;h=n.navigator;l(i,{hasToken:t.location.hash=="#ath"||u.test(t.location.href)||f.test(t.location.search),isRetina:n.devicePixelRatio&&n.devicePixelRatio>1,isIDevice:/iphone|ipod|ipad/i.test(r)&&r.indexOf("Trident")===-1,isMobileChrome:r.indexOf("Android")>-1&&/Chrome\/[.0-9]*/.test(r),isMobileIE:r.indexOf("Windows Phone")>-1,language:h.language&&h.language.toLowerCase().replace("-","_")||""});i.language=i.language&&i.language in i.intl?i.language:"en_us";i.isMobileSafari=i.isIDevice&&r.indexOf("Safari")>-1&&r.indexOf("CriOS")<0;i.OS=i.isIDevice?"ios":i.isMobileChrome?"android":i.isMobileIE?"windows":"unsupported";i.OSVersion=r.match(/(OS|Android) (\d+[_\.]\d+)/);i.OSVersion=i.OSVersion&&i.OSVersion[2]?+i.OSVersion[2].replace("_","."):0;i.isStandalone=n.navigator.standalone||i.isMobileChrome&&screen.height-t.documentElement.clientHeight<40||i.isMobileIE&&n.external.msIsSiteMode();i.isTablet=i.isMobileSafari&&r.indexOf("iPad")>-1||i.isMobileChrome&&r.indexOf("Mobile")<0;i.isCompatible=i.isMobileSafari&&i.OSVersion>=6||i.isMobileChrome||i.isMobileIE;c={lastDisplayTime:0,returningVisitor:!1,displayCount:0,optedout:!1,added:!1};i.removeSession=function(n){try{localStorage.removeItem(n||i.defaults.appID)}catch(t){}};i.Class=function(r){var u,f;if((this.options=l({},i.defaults),l(this.options,r),a)&&(this.options.mandatory=this.options.mandatory&&("standalone"in n.navigator||this.options.debug),this.options.modal=this.options.modal||this.options.mandatory,this.options.mandatory&&(this.options.startDelay=-.5),this.options.detectHomescreen=this.options.detectHomescreen===!0?"hash":this.options.detectHomescreen,this.options.debug&&(i.isCompatible=!0,i.OS=typeof this.options.debug=="string"?this.options.debug:i.OS=="unsupported"?"android":i.OS,i.OSVersion=i.OS=="ios"?"8":"4"),this.container=t.documentElement,this.session=localStorage.getItem(this.options.appID),this.session=this.session?JSON.parse(this.session):undefined,!i.hasToken||i.isCompatible&&this.session||(i.hasToken=!1,y()),i.isCompatible)){this.session=this.session||c;try{localStorage.setItem(this.options.appID,JSON.stringify(this.session));i.hasLocalStorage=!0}catch(e){i.hasLocalStorage=!1;this.options.onPrivate&&this.options.onPrivate.call(this)}for(u=!this.options.validLocation.length,f=this.options.validLocation.length;f--;)if(this.options.validLocation[f].test(t.location.href)){u=!0;break}if(localStorage.getItem("addToHome")&&this.optOut(),!this.session.optedout&&!this.session.added&&u){if(i.isStandalone){this.session.added||(this.session.added=!0,this.updateSession(),this.options.onAdd&&i.hasLocalStorage&&this.options.onAdd.call(this));return}if(this.options.detectHomescreen){if(i.hasToken){y();this.session.added||(this.session.added=!0,this.updateSession(),this.options.onAdd&&i.hasLocalStorage&&this.options.onAdd.call(this));return}this.options.detectHomescreen=="hash"?history.replaceState("",n.document.title,t.location.href+"#ath"):this.options.detectHomescreen=="smartURL"?history.replaceState("",n.document.title,t.location.href.replace(/(\/)?$/,"/ath$1")):history.replaceState("",n.document.title,t.location.href+(t.location.search?"&":"?")+"ath=")}(this.session.returningVisitor||(this.session.returningVisitor=!0,this.updateSession(),!this.options.skipFirstVisit))&&(this.options.privateModeOverride||i.hasLocalStorage)&&(this.ready=!0,this.options.onInit&&this.options.onInit.call(this),this.options.autostart&&this.show())}}};i.Class.prototype={events:{load:"_delayedShow",error:"_delayedShow",orientationchange:"resize",resize:"resize",scroll:"resize",click:"remove",touchmove:"_preventDefault",transitionend:"_removeElements",webkitTransitionEnd:"_removeElements",MSTransitionEnd:"_removeElements"},handleEvent:function(n){var t=this.events[n.type];t&&this[t](n)},show:function(r){var f,o,u;if(this.options.autostart&&!e){setTimeout(this.show.bind(this),50);return}if(!this.shown){if(f=Date.now(),o=this.session.lastDisplayTime,r!==!0){if(!this.ready)return;if(f-o<this.options.displayPace*6e4)return;if(this.options.maxDisplayCount&&this.session.displayCount>=this.options.maxDisplayCount)return}this.shown=!0;this.session.lastDisplayTime=f;this.session.displayCount++;this.updateSession();this.applicationIcon||(this.applicationIcon=i.OS=="ios"?t.querySelector('head link[rel^=apple-touch-icon][sizes="152x152"],head link[rel^=apple-touch-icon][sizes="144x144"],head link[rel^=apple-touch-icon][sizes="120x120"],head link[rel^=apple-touch-icon][sizes="114x114"],head link[rel^=apple-touch-icon]'):t.querySelector('head link[rel^="shortcut icon"][sizes="196x196"],head link[rel^=apple-touch-icon]'));u="";u=this.options.message in i.intl?i.intl[this.options.message][i.OS]:this.options.message!==""?this.options.message:i.intl[i.language][i.OS];u="<p>"+u.replace("%icon",'<span class="ath-action-icon">icon<\/span>')+"<\/p>";this.viewport=t.createElement("div");this.viewport.className="ath-viewport";this.options.modal&&(this.viewport.className+=" ath-modal");this.options.mandatory&&(this.viewport.className+=" ath-mandatory");this.viewport.style.position="absolute";this.element=t.createElement("div");this.element.className="ath-container ath-"+i.OS+" ath-"+i.OS+(i.OSVersion+"").substr(0,1)+" ath-"+(i.isTablet?"tablet":"phone");this.element.style.cssText="-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0s;-webkit-transition-timing-function:ease-out;transition-property:transform,opacity;transition-duration:0s;transition-timing-function:ease-out;";this.element.style.webkitTransform="translate3d(0,-"+n.innerHeight+"px,0)";this.element.style.transform="translate3d(0,-"+n.innerHeight+"px,0)";this.options.icon&&this.applicationIcon&&(this.element.className+=" ath-icon",this.img=t.createElement("img"),this.img.className="ath-application-icon",this.img.addEventListener("load",this,!1),this.img.addEventListener("error",this,!1),this.img.src=this.applicationIcon.href,this.element.appendChild(this.img));this.element.innerHTML+=u;this.viewport.style.left="-99999em";this.viewport.appendChild(this.element);this.container.appendChild(this.viewport);this.img||this._delayedShow()}},_delayedShow:function(){setTimeout(this._show.bind(this),this.options.startDelay*1e3+500)},_show:function(){var i=this;this.updateViewport();n.addEventListener("resize",this,!1);n.addEventListener("scroll",this,!1);n.addEventListener("orientationchange",this,!1);this.options.modal&&t.addEventListener("touchmove",this,!0);this.options.mandatory||setTimeout(function(){i.element.addEventListener("click",i,!0)},1e3);setTimeout(function(){i.element.style.webkitTransitionDuration="1.2s";i.element.style.transitionDuration="1.2s";i.element.style.webkitTransform="translate3d(0,0,0)";i.element.style.transform="translate3d(0,0,0)"},0);this.options.lifespan&&(this.removeTimer=setTimeout(this.remove.bind(this),this.options.lifespan*1e3));this.options.onShow&&this.options.onShow.call(this)},remove:function(){clearTimeout(this.removeTimer);this.img&&(this.img.removeEventListener("load",this,!1),this.img.removeEventListener("error",this,!1));n.removeEventListener("resize",this,!1);n.removeEventListener("scroll",this,!1);n.removeEventListener("orientationchange",this,!1);t.removeEventListener("touchmove",this,!0);this.element.removeEventListener("click",this,!0);this.element.addEventListener("transitionend",this,!1);this.element.addEventListener("webkitTransitionEnd",this,!1);this.element.addEventListener("MSTransitionEnd",this,!1);this.element.style.webkitTransitionDuration="0.3s";this.element.style.opacity="0"},_removeElements:function(){this.element.removeEventListener("transitionend",this,!1);this.element.removeEventListener("webkitTransitionEnd",this,!1);this.element.removeEventListener("MSTransitionEnd",this,!1);this.container.removeChild(this.viewport);this.shown=!1;this.options.onRemove&&this.options.onRemove.call(this)},updateViewport:function(){var r,u;this.shown&&(this.viewport.style.width=n.innerWidth+"px",this.viewport.style.height=n.innerHeight+"px",this.viewport.style.left=n.scrollX+"px",this.viewport.style.top=n.scrollY+"px",r=t.documentElement.clientWidth,this.orientation=r>t.documentElement.clientHeight?"landscape":"portrait",u=i.OS=="ios"?this.orientation=="portrait"?screen.width:screen.height:screen.width,this.scale=screen.width>r?1:u/n.innerWidth,this.element.style.fontSize=this.options.fontSize/this.scale+"px")},resize:function(){clearTimeout(this.resizeTimer);this.resizeTimer=setTimeout(this.updateViewport.bind(this),100)},updateSession:function(){i.hasLocalStorage!==!1&&localStorage.setItem(this.options.appID,JSON.stringify(this.session))},clearSession:function(){this.session=c;this.updateSession()},optOut:function(){this.session.optedout=!0;this.updateSession()},optIn:function(){this.session.optedout=!1;this.updateSession()},clearDisplayCount:function(){this.session.displayCount=0;this.updateSession()},_preventDefault:function(n){n.preventDefault();n.stopPropagation()}};n.addToHomescreen=i})(window,document);
//# sourceMappingURL=addtohomescreen.min.js.map
